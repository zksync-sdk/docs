---
title: Providers
description: "A guide to Web3 Provider objects for zkSync integration"
tags: ["zksync", "ethereum", "zkSync Era", "transactions", "provider"]
---

## Introduction

A Web3 Provider object gives your application access to underlying blockchain networks. The `zksync-ethers` library
extends the functionality of the `ethers.js` library to include zkSync-specific methods.

## Available Providers

::card-group
::card{title="Provider" icon="i-heroicons-globe-alt" color="blue"}
Similar to `ethers.JsonRpcProvider`, but with additional zkSync methods.
::
::card{title="BrowserProvider" icon="i-heroicons-globe-alt" color="blue"}
Extends the zkSync Era `Provider` for better compatibility with Web3 wallets.
::
::

::callout{icon="i-heroicons-light-bulb"}
Use `BrowserProvider` for browser integrations.
::

## `Provider`

### Constructor

Creates a zkSync Era `Provider` object.

#### Parameters

| Name       | Type                                                   | Description                                   |
|------------|--------------------------------------------------------|-----------------------------------------------|
| `url?`     | `ethers.FetchRequest \| string`                        | Optional network RPC URL.                     |
| `network?` | `ethers.Networkish`                                     | Optional network details.                     |
| `options?` | `any`                                                  | Optional additional provider options.         |

```typescript
constructor(url?: ethers.FetchRequest | string, network?: Networkish, options?: any)
```

#### Example

```typescript
import { Provider } from "zksync-ethers";

const provider = new Provider("https://sepolia.era.zksync.dev");
```

### `broadcastTransaction`

Sends a signed transaction.

#### Parameters

| Name      | Type     | Description          |
|-----------|----------|----------------------|
| `signedTx`| `string` | Signed transaction.  |

```typescript
async broadcastTransaction(signedTx: string): Promise<TransactionResponse>
```

#### Example

```typescript
import { Provider, types, Wallet } from "zksync-ethers";

const PRIVATE_KEY = "<PRIVATE_KEY>";
const provider = Provider.getDefaultProvider(types.Network.Sepolia);
const wallet = new Wallet(PRIVATE_KEY, provider);

const signedTx = await wallet.signTransaction({
  to: "0xa61464658AfeAf65CccaaFD3a512b69A83B77618",
  value: ethers.parseEther("0.01"),
});
const tx = await provider.broadcastTransaction(signedTx);
console.log(tx.hash);
```

### `estimateFee`

Estimates the fee for a transaction.

#### Parameters

| Name         | Type                       | Description             |
|--------------|----------------------------|-------------------------|
| `transaction`| `TransactionRequest`       | The transaction request.|

```typescript
async estimateFee(transaction: TransactionRequest): Promise<Fee>
```

#### Example

```typescript
import { Provider, types } from "zksync-ethers";

const provider = Provider.getDefaultProvider(types.Network.Sepolia);
const fee = await provider.estimateFee({
  from: "0x36615Cf349d7F6344891B1e7CA7C72883F5dc049",
  to: "0xa61464658AfeAf65CccaaFD3a512b69A83B77618",
  value: `0x${BigInt(7_000_000_000).toString(16)}`,
});
console.log(`Fee: ${toJSON(fee)}`);
```

### `estimateGas`

Estimates the gas required for a transaction.

#### Parameters

| Name  | Type                       | Description             |
|-------|----------------------------|-------------------------|
| `_tx` | `TransactionRequest`       | The transaction request.|

```typescript
async estimateGas(_tx: TransactionRequest): Promise<bigint>
```

#### Example

```typescript
import { Provider, types, utils } from "zksync-ethers";

const provider = Provider.getDefaultProvider(types.Network.Sepolia);
const gasTokenApprove = await provider.estimateGas({
  from: "0x36615Cf349d7F6344891B1e7CA7C72883F5dc049",
  to: "0x765F5AF819D818a8e8ee6ff63D8d0e8056DBE150",
  data: utils.IERC20.encodeFunctionData("approve", [RECEIVER, 1]),
});
console.log(`Gas for token approval tx: ${gasTokenApprove}`);
```

### `getAllAccountBalances`

Returns all balances for confirmed tokens given an account address.

#### Parameters

| Name     | Type      | Description     |
|----------|-----------|-----------------|
| `address`| `Address` | Account address.|

```typescript
async getAllAccountBalances(address: Address): Promise<BalancesMap>
```

#### Example

```typescript
import { Provider, types } from "zksync-ethers";

const provider = Provider.getDefaultProvider(types.Network.Sepolia);
const balances = await provider.getAllAccountBalances("0x36615Cf349d7F6344891B1e7CA7C72883F5dc049");
console.log(`All balances: ${toJSON(balances)}`);
```

### `getBalance`

Returns the user's balance as a `bigint` object for an optional block tag and token.

#### Parameters

| Name           | Type      | Description                      |
|----------------|-----------|----------------------------------|
| `address`      | `Address` | Account address.                 |
| `blockTag?`    | `BlockTag`| Optional block tag.              |
| `tokenAddress?`| `Address` | Optional token address (default: ETH).|

```typescript
async getBalance(address: Address, blockTag?: BlockTag, tokenAddress?: Address)
```

#### Example

```typescript
import { Provider, types } from "zksync-ethers";

const provider = Provider.getDefaultProvider(types.Network.Sepolia);
const account = "0x36615Cf349d7F6344891B1e7CA7C72883F5dc049";
const tokenAddress = "0x927488F48ffbc32112F1fF721759649A89721F8F";
console.log(`ETH balance: ${await provider.getBalance(account)}`);
console.log(`Token balance: ${await provider.getBalance(account, "latest", tokenAddress)}`);
```

## `BrowserProvider`

Use this provider for Web3 browser wallet integrations.

### Constructor

Creates a `BrowserProvider` object using an `Eip1193Provider`.

#### Parameters

| Name       | Type                                  | Description                                |
|------------|---------------------------------------|--------------------------------------------|
| `ethereum` | `Eip1193Provider`                     | `Eip1193Provider` instance (e.g., Metamask).|
| `network?` | `Networkish`                          | Optional network name.                     |

```typescript
constructor(ethereum: Eip1193Provider, network?: Networkish)
```

#### Example

```typescript
import { BrowserProvider } from "zksync-ethers";

const provider = new BrowserProvider(window.ethereum);
```

### `estimateGas`

Overrides the zkSync Era `estimateGas` method.

#### Parameters

| Name        | Type                       | Description             |
|-------------|----------------------------|-------------------------|
| `transaction`| `TransactionRequest`       | The transaction request.|

```typescript
async estimateGas(transaction: TransactionRequest): Promise<bigint>
```

#### Example

```typescript
import { BrowserProvider } from "zksync-ethers";

const provider = new BrowserProvider(window.ethereum);
const gas = await provider.estimateGas({
  to: "<RECEIVER>",
  amount: ethers.parseEther("0.01"),
});
console.log(`Gas: ${gas}`);
```

### `getSigner`

Overrides the `ethers.js` `getSigner` method.

#### Parameters

| Name     | Type                  | Description                 |
|----------|-----------------------|-----------------------------|
| `address?`| `number \| string`    | Optional account address or index.|

```typescript
async getSigner(address?: number | string): Promise<Signer>
```

#### Example

```typescript
import { BrowserProvider } from "zksync-ethers";

const provider = new BrowserProvider(window.ethereum);
const signer = await provider.getSigner();
```

## Appendix

### toJSON

Helper function to convert objects to JSON, handling `BigInt`.

```typescript
function toJSON(object: any): string {
  return JSON.stringify(object, (key, value) => {
    if (typeof value === "bigint") {
      return value.toString(); // Convert BigInt to string
    }
    return value;
  });
}
```
